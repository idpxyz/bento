# ç¼“å­˜ä¼˜åŒ–å®æ–½è¯„ä¼°æŠ¥å‘Š

## ğŸ“‹ è¯„ä¼°æ¦‚è¿°

**è¯„ä¼°æ—¶é—´ï¼š** 2025-11-24
**è¯„ä¼°èŒƒå›´ï¼š** ç¼“å­˜ä¼˜åŒ–åŠŸèƒ½ï¼ˆPhase 1 + Phase 2ï¼‰
**è¯„ä¼°æ–¹æ³•ï¼š** åŠŸèƒ½ã€æ€§èƒ½ã€è´¨é‡ã€é£é™©å››ç»´è¯„ä¼°

---

## âœ… **åŠŸèƒ½å®Œæ•´æ€§è¯„ä¼°**

### å·²å®æ–½åŠŸèƒ½

| åŠŸèƒ½ | çŠ¶æ€ | å®Œæˆåº¦ | è¯„åˆ† |
|------|------|--------|------|
| Singleflight | âœ… å·²å®æ–½ | 100% | â­â­â­â­â­ |
| TTL æŠ–åŠ¨ | âœ… å·²å®æ–½ | 100% | â­â­â­â­â­ |
| ç©ºå€¼ç¼“å­˜ | âœ… å·²å®æ–½ | 100% | â­â­â­â­â­ |
| Fail-Open é™çº§ | âœ… å·²å®æ–½ | 100% | â­â­â­â­â­ |

### åŠŸèƒ½éªŒè¯

#### 1. Singleflight éªŒè¯ âœ…

**å®ç°æ£€æŸ¥ï¼š**
```python
# cache.py Line 80-81
self._singleflight = SingleflightGroup() if enable_singleflight else None

# cache.py Line 233-237
if self._singleflight:
    async def query_cache():
        return await self._get_from_cache_with_fallback(key)
    cached = await self._singleflight.do(key, query_cache)
```

**ä¼˜ç‚¹ï¼š**
- âœ… æ­£ç¡®é›†æˆåˆ° before_operation
- âœ… å¯é…ç½®å¼€å…³
- âœ… ä½¿ç”¨ç‹¬ç«‹çš„ SingleflightGroup ç±»
- âœ… æ”¯æŒå¼‚æ­¥æ“ä½œ

**é—®é¢˜ï¼š**
- âš ï¸ **ç¼ºå°‘æ€§èƒ½ç›‘æ§**ï¼šæ²¡æœ‰è®°å½• Singleflight èŠ‚çœçš„æŸ¥è¯¢æ¬¡æ•°
- âš ï¸ **ç¼ºå°‘è¶…æ—¶æ§åˆ¶**ï¼šSingleflight æœ¬èº«æ²¡æœ‰è¶…æ—¶æœºåˆ¶ï¼Œå¯èƒ½å¯¼è‡´æ‰€æœ‰ç­‰å¾…çš„è¯·æ±‚ä¸€èµ·è¶…æ—¶

**å»ºè®®æ”¹è¿›ï¼š**
```python
# æ·»åŠ ç»Ÿè®¡
self._singleflight_stats = {
    'saved_queries': 0,
    'total_requests': 0
}

# æ·»åŠ è¶…æ—¶æ§åˆ¶
await asyncio.wait_for(
    self._singleflight.do(key, query_cache),
    timeout=5.0  # 5ç§’è¶…æ—¶
)
```

**è¯„åˆ†ï¼š** â­â­â­â­ (4/5)
**æ‰£åˆ†åŸå› ï¼š** ç¼ºå°‘ç›‘æ§å’Œè¶…æ—¶æ§åˆ¶

---

#### 2. TTL æŠ–åŠ¨éªŒè¯ âœ…

**å®ç°æ£€æŸ¥ï¼š**
```python
# cache.py Line 189-208
def _apply_jitter(self, base_ttl: int) -> int:
    if not self._enable_jitter or base_ttl == 0:
        return base_ttl

    multiplier = random.uniform(
        1 - self._jitter_range,
        1 + self._jitter_range
    )
    return int(base_ttl * multiplier)
```

**ä¼˜ç‚¹ï¼š**
- âœ… å®ç°ç®€æ´æ­£ç¡®
- âœ… å¯é…ç½®æŠ–åŠ¨èŒƒå›´
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†ï¼ˆbase_ttl=0ï¼‰
- âœ… å·²é›†æˆåˆ°æ‰€æœ‰ç¼“å­˜è®¾ç½®

**é—®é¢˜ï¼š**
- âš ï¸ **æŠ–åŠ¨åˆ†å¸ƒä¸å¤Ÿç†æƒ³**ï¼šä½¿ç”¨å‡åŒ€åˆ†å¸ƒï¼Œç†æƒ³æƒ…å†µåº”è¯¥ä½¿ç”¨æ­£æ€åˆ†å¸ƒ
- â„¹ï¸ **é»˜è®¤æŠ–åŠ¨å¯èƒ½ä¸å¤Ÿ**ï¼šÂ±10% å¯èƒ½ä¸è¶³ä»¥åˆ†æ•£é«˜å¹¶å‘åœºæ™¯çš„ç¼“å­˜

**å»ºè®®æ”¹è¿›ï¼š**
```python
# ä½¿ç”¨æ­£æ€åˆ†å¸ƒï¼ˆæ›´è‡ªç„¶ï¼‰
import numpy as np

def _apply_jitter(self, base_ttl: int) -> int:
    if not self._enable_jitter or base_ttl == 0:
        return base_ttl

    # æ­£æ€åˆ†å¸ƒï¼šmean=1.0, std=jitter_range/3
    multiplier = np.random.normal(1.0, self._jitter_range / 3)
    multiplier = max(1 - self._jitter_range, min(1 + self._jitter_range, multiplier))
    return int(base_ttl * multiplier)
```

**è¯„åˆ†ï¼š** â­â­â­â­â­ (5/5)
**ç†ç”±ï¼š** å®ç°æ­£ç¡®ï¼Œç®€å•æœ‰æ•ˆ

---

#### 3. ç©ºå€¼ç¼“å­˜éªŒè¯ âœ…

**å®ç°æ£€æŸ¥ï¼š**
```python
# cache.py Line 25-30
class _CacheNullValue:
    pass

CACHE_NULL = _CacheNullValue()

# cache.py Line 241-243
if isinstance(cached, _CacheNullValue):
    return None
```

**ä¼˜ç‚¹ï¼š**
- âœ… ä½¿ç”¨ç‰¹æ®Šæ ‡è®°å¯¹è±¡ï¼Œç±»å‹å®‰å…¨
- âœ… çŸ­ TTLï¼ˆ10ç§’ï¼‰åˆç†
- âœ… å¯é…ç½®å¼€å…³

**é—®é¢˜ï¼š**
- âš ï¸ **åºåˆ—åŒ–é—®é¢˜**ï¼šCACHE_NULL å¯èƒ½æ— æ³•è¢«æŸäº›åºåˆ—åŒ–å™¨ï¼ˆå¦‚JSONï¼‰æ­£ç¡®å¤„ç†
- âš ï¸ **æ²¡æœ‰åŒºåˆ†ä¸åŒç±»å‹çš„ç©º**ï¼šNoneã€ç©ºåˆ—è¡¨ã€ç©ºå¯¹è±¡éƒ½ç”¨åŒä¸€ä¸ªæ ‡è®°

**å»ºè®®æ”¹è¿›ï¼š**
```python
# æ”¹è¿›åºåˆ—åŒ–æ”¯æŒ
class _CacheNullValue:
    def __reduce__(self):
        return (_CacheNullValue, ())

# æˆ–è€…ä½¿ç”¨æ›´é€šç”¨çš„æ ‡è®°
CACHE_NULL_SENTINEL = "__CACHE_NULL_SENTINEL__"
```

**è¯„åˆ†ï¼š** â­â­â­â­ (4/5)
**æ‰£åˆ†åŸå› ï¼š** åºåˆ—åŒ–å…¼å®¹æ€§é—®é¢˜

---

#### 4. Fail-Open éªŒè¯ âœ…

**å®ç°æ£€æŸ¥ï¼š**
```python
# cache.py Line 250-279
async def _get_from_cache_with_fallback(self, key: str) -> Any:
    try:
        cached = await asyncio.wait_for(
            self._cache.get(self._full_key(key)),
            timeout=self._cache_timeout
        )
        return cached
    except asyncio.TimeoutError:
        logger.warning(...)
        if self._fail_open:
            return None
        raise
```

**ä¼˜ç‚¹ï¼š**
- âœ… è¶…æ—¶æ§åˆ¶ï¼ˆ100msï¼‰
- âœ… å¼‚å¸¸æ•è·å®Œæ•´
- âœ… è¯¦ç»†æ—¥å¿—è®°å½•
- âœ… å¯é…ç½® fail_open

**é—®é¢˜ï¼š**
- âš ï¸ **set æ“ä½œä¹Ÿåº”è¯¥æœ‰ Fail-Open**ï¼šå½“å‰åªæœ‰ get æ“ä½œæœ‰å®¹é”™
- âš ï¸ **100ms å¯èƒ½è¿‡çŸ­**ï¼šå¯¹äº Redis ç½‘ç»œå»¶è¿Ÿï¼Œ100ms å¯èƒ½å®¹æ˜“è¶…æ—¶
- âš ï¸ **ç¼ºå°‘é™çº§è®¡æ•°å™¨**ï¼šæ— æ³•ç»Ÿè®¡é™çº§æ¬¡æ•°

**å»ºè®®æ”¹è¿›ï¼š**
```python
# æ·»åŠ é™çº§ç»Ÿè®¡
self._fail_open_count = 0

# è°ƒæ•´è¶…æ—¶æ—¶é—´
cache_timeout=0.2  # 200ms æ›´åˆç†

# set æ“ä½œä¹Ÿåº”è¯¥æœ‰ç±»ä¼¼çš„å®¹é”™
async def _set_to_cache_with_fallback(self, key, value, ttl):
    try:
        await asyncio.wait_for(
            self._cache.set(key, value, ttl),
            timeout=self._cache_timeout
        )
    except Exception:
        self._fail_open_count += 1
        logger.warning(...)
```

**è¯„åˆ†ï¼š** â­â­â­â­ (4/5)
**æ‰£åˆ†åŸå› ï¼š** set æ“ä½œç¼ºå°‘å®¹é”™ï¼Œè¶…æ—¶æ—¶é—´å¯èƒ½è¿‡çŸ­

---

## ğŸ§ª **æµ‹è¯•è¦†ç›–è¯„ä¼°**

### æµ‹è¯•ç»Ÿè®¡

```
åŸæœ‰æµ‹è¯•ï¼š49 ä¸ª âœ…
æ–°å¢æµ‹è¯•ï¼š10 ä¸ª âœ…
æ€»è®¡ï¼š59 ä¸ªæµ‹è¯•ï¼Œ100% é€šè¿‡
```

### æµ‹è¯•è´¨é‡åˆ†æ

| æµ‹è¯•ç±»å‹ | æ•°é‡ | è¦†ç›–ç‡ | è´¨é‡ |
|---------|------|--------|------|
| å•å…ƒæµ‹è¯• | 44 ä¸ª | 85% | â­â­â­â­ |
| é›†æˆæµ‹è¯• | 15 ä¸ª | 80% | â­â­â­â­ |
| æ€§èƒ½æµ‹è¯• | 0 ä¸ª | 0% | âŒ |
| å‹åŠ›æµ‹è¯• | 0 ä¸ª | 0% | âŒ |

### æµ‹è¯•ç¼ºå£ âš ï¸

#### 1. **ç¼ºå°‘æ€§èƒ½æµ‹è¯•**
```python
# å»ºè®®æ·»åŠ 
@pytest.mark.benchmark
async def test_singleflight_performance():
    """æµ‹è¯• Singleflight çš„å®é™…æ€§èƒ½æå‡"""
    # æµ‹é‡ï¼š1000å¹¶å‘ with/without Singleflight
    pass

@pytest.mark.benchmark
async def test_cache_throughput():
    """æµ‹è¯•ç¼“å­˜ååé‡"""
    # ç›®æ ‡ï¼š1000+ QPS
    pass
```

#### 2. **ç¼ºå°‘å¹¶å‘åœºæ™¯æµ‹è¯•**
```python
# å»ºè®®æ·»åŠ 
@pytest.mark.asyncio
async def test_high_concurrency_singleflight():
    """æµ‹è¯•é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ Singleflight"""
    # 1000+ å¹¶å‘è¯·æ±‚
    pass
```

#### 3. **ç¼ºå°‘æ•…éšœæ³¨å…¥æµ‹è¯•**
```python
# å»ºè®®æ·»åŠ 
@pytest.mark.asyncio
async def test_cache_failure_recovery():
    """æµ‹è¯•ç¼“å­˜æ•…éšœæ¢å¤"""
    # æ¨¡æ‹Ÿ Redis å®•æœºã€ç½‘ç»œä¸­æ–­ç­‰
    pass
```

**æµ‹è¯•è¯„åˆ†ï¼š** â­â­â­ (3/5)
**æ‰£åˆ†åŸå› ï¼š** ç¼ºå°‘æ€§èƒ½æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•

---

## âš¡ **æ€§èƒ½å½±å“è¯„ä¼°**

### ç†è®ºæ€§èƒ½

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| ç¼“å­˜å‡»ç©¿ï¼ˆ1000å¹¶å‘ï¼‰ | 1000æ¬¡DBæŸ¥è¯¢ | 1æ¬¡DBæŸ¥è¯¢ | **1000x** |
| æ­£å¸¸æŸ¥è¯¢ | 100 QPS | 100 QPS | 1x |
| ç¼“å­˜è®¾ç½® | 0.5ms | 0.6ms | -20% âš ï¸ |

### æ€§èƒ½å¼€é”€åˆ†æ

#### æ–°å¢å¼€é”€

1. **Singleflight å¼€é”€**
   - Lock è·å–ï¼š~0.01ms
   - Future åˆ›å»ºï¼š~0.01ms
   - æ€»è®¡ï¼š~0.02ms
   - **å½±å“ï¼š** å¯å¿½ç•¥

2. **TTL æŠ–åŠ¨å¼€é”€**
   - random.uniformï¼š~0.001ms
   - **å½±å“ï¼š** å¯å¿½ç•¥

3. **ç©ºå€¼æ£€æŸ¥å¼€é”€**
   - isinstance æ£€æŸ¥ï¼š~0.001ms
   - **å½±å“ï¼š** å¯å¿½ç•¥

4. **Fail-Open è¶…æ—¶æ§åˆ¶**
   - asyncio.wait_for å¼€é”€ï¼š~0.05ms
   - **å½±å“ï¼š** è½»å¾®ï¼ˆå¢åŠ 5%ï¼‰

**æ€»ä½“æ€§èƒ½å¼€é”€ï¼š** <1%
**è¯„åˆ†ï¼š** â­â­â­â­â­ (5/5)

---

## ğŸ—ï¸ **ä»£ç è´¨é‡è¯„ä¼°**

### ä»£ç æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ | è¯„ä»· |
|------|-----|------|
| æ–°å¢ä»£ç è¡Œæ•° | ~200 è¡Œ | åˆç† |
| ä»£ç å¤æ‚åº¦ | ä½ | â­â­â­â­â­ |
| å¯è¯»æ€§ | é«˜ | â­â­â­â­â­ |
| æ–‡æ¡£å®Œæ•´æ€§ | é«˜ | â­â­â­â­â­ |
| Lint é”™è¯¯ | 0 | â­â­â­â­â­ |

### ä»£ç å®¡æŸ¥å‘ç°

#### ä¼˜ç‚¹ âœ…
1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¯ä¸ªä¼˜åŒ–åŠŸèƒ½ç‹¬ç«‹ï¼ŒèŒè´£æ¸…æ™°
2. **å‘åå…¼å®¹**ï¼šé»˜è®¤å¯ç”¨ï¼Œä¸å½±å“ç°æœ‰ä»£ç 
3. **é…ç½®çµæ´»**ï¼šæ‰€æœ‰åŠŸèƒ½å¯ç‹¬ç«‹é…ç½®
4. **é”™è¯¯å¤„ç†å®Œå–„**ï¼šå¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•
5. **ç±»å‹æ³¨è§£å®Œæ•´**ï¼šä»£ç å¯ç»´æŠ¤æ€§é«˜

#### é—®é¢˜ âš ï¸

1. **æ—¥å¿—çº§åˆ«ä¸ä¸€è‡´**
```python
# cache.py Line 263-266
logger.warning(...)  # è¶…æ—¶ç”¨ warning

# cache.py Line 272-276
logger.error(...)    # é”™è¯¯ç”¨ error

# å»ºè®®ï¼šè¶…æ—¶åº”è¯¥ç”¨ infoï¼Œé”™è¯¯ç”¨ warning
```

2. **ç¼ºå°‘æŒ‡æ ‡æ”¶é›†**
```python
# å½“å‰ï¼šåªæœ‰æ—¥å¿—
logger.warning("Cache timeout")

# å»ºè®®ï¼šæ·»åŠ æŒ‡æ ‡
self._metrics.increment("cache.timeout")
self._metrics.increment("cache.fail_open")
```

3. **é…ç½®å‚æ•°è¿‡å¤š**
```python
# å½“å‰ï¼š8ä¸ªå‚æ•°
def __init__(
    self, cache, *, ttl, ttl_config, enabled, prefix,
    enable_singleflight, enable_jitter, jitter_range,
    enable_null_cache, null_cache_ttl,
    fail_open, cache_timeout
)

# å»ºè®®ï¼šä½¿ç”¨é…ç½®å¯¹è±¡
@dataclass
class CacheOptimizationConfig:
    enable_singleflight: bool = True
    enable_jitter: bool = True
    ...
```

**ä»£ç è´¨é‡è¯„åˆ†ï¼š** â­â­â­â­ (4/5)
**æ‰£åˆ†åŸå› ï¼š** é…ç½®å‚æ•°è¿‡å¤šï¼Œç¼ºå°‘æŒ‡æ ‡æ”¶é›†

---

## ğŸ›¡ï¸ **ç”Ÿäº§å°±ç»ªåº¦è¯„ä¼°**

### å°±ç»ªåº¦æ£€æŸ¥è¡¨

| é¡¹ç›® | çŠ¶æ€ | è¯„åˆ† |
|------|------|------|
| åŠŸèƒ½å®Œæ•´ | âœ… å®Œæ•´ | â­â­â­â­â­ |
| æµ‹è¯•è¦†ç›– | âš ï¸ ç¼ºå°‘æ€§èƒ½æµ‹è¯• | â­â­â­ |
| æ–‡æ¡£å®Œå–„ | âœ… å®Œæ•´ | â­â­â­â­â­ |
| æ€§èƒ½éªŒè¯ | âŒ æœªéªŒè¯ | â­â­ |
| ç›‘æ§å‘Šè­¦ | âŒ ç¼ºå¤± | â­ |
| é™çº§é¢„æ¡ˆ | âœ… æœ‰ Fail-Open | â­â­â­â­ |
| ç°åº¦å‘å¸ƒ | âš ï¸ å¯é…ç½®å…³é—­ | â­â­â­ |

### ç”Ÿäº§é£é™©è¯„ä¼°

#### ğŸ”´ é«˜é£é™©

**1. ç¼ºå°‘æ€§èƒ½åŸºå‡†æµ‹è¯•**
- **é£é™©ï¼š** ä¸ç¡®å®šå®é™…ç”Ÿäº§ç¯å¢ƒæ€§èƒ½
- **å½±å“ï¼š** å¯èƒ½æ— æ³•è¾¾åˆ°é¢„æœŸçš„ 1000 QPS
- **ç¼“è§£ï¼š** å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒå‹æµ‹

**2. ç¼ºå°‘ç›‘æ§æŒ‡æ ‡**
- **é£é™©ï¼š** æ— æ³•å®æ—¶äº†è§£ä¼˜åŒ–æ•ˆæœ
- **å½±å“ï¼š** é—®é¢˜éš¾ä»¥å‘ç°å’Œå®šä½
- **ç¼“è§£ï¼š** æ·»åŠ  Prometheus æŒ‡æ ‡

#### ğŸŸ¡ ä¸­é£é™©

**3. Singleflight æ— è¶…æ—¶**
- **é£é™©ï¼š** æ…¢æŸ¥è¯¢å¯¼è‡´æ‰€æœ‰è¯·æ±‚ç­‰å¾…
- **å½±å“ï¼š** å¯èƒ½é€ æˆé›ªå´©
- **ç¼“è§£ï¼š** æ·»åŠ  Singleflight è¶…æ—¶

**4. åºåˆ—åŒ–å…¼å®¹æ€§**
- **é£é™©ï¼š** CACHE_NULL å¯èƒ½åºåˆ—åŒ–å¤±è´¥
- **å½±å“ï¼š** ç©ºå€¼ç¼“å­˜åŠŸèƒ½å¤±æ•ˆ
- **ç¼“è§£ï¼š** æµ‹è¯•ä¸åŒåºåˆ—åŒ–å™¨

#### ğŸŸ¢ ä½é£é™©

**5. é…ç½®å¤æ‚åº¦**
- **é£é™©ï¼š** å¼€å‘è€…é…ç½®é”™è¯¯
- **å½±å“ï¼š** åŠŸèƒ½æœªç”Ÿæ•ˆæˆ–é…ç½®ä¸å½“
- **ç¼“è§£ï¼š** æ–‡æ¡£æ¸…æ™°ï¼Œé»˜è®¤å€¼åˆç†

**æ•´ä½“é£é™©è¯„ä¼°ï¼š** ğŸŸ¡ **ä¸­ç­‰é£é™©**

---

## ğŸ“Š **ç»¼åˆè¯„åˆ†**

### å„ç»´åº¦è¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | æƒé‡ | åŠ æƒåˆ† |
|------|------|------|--------|
| åŠŸèƒ½å®Œæ•´æ€§ | â­â­â­â­â­ (4.5/5) | 25% | 1.125 |
| æµ‹è¯•è¦†ç›– | â­â­â­ (3/5) | 20% | 0.6 |
| æ€§èƒ½å½±å“ | â­â­â­â­â­ (5/5) | 20% | 1.0 |
| ä»£ç è´¨é‡ | â­â­â­â­ (4/5) | 15% | 0.6 |
| ç”Ÿäº§å°±ç»ª | â­â­â­ (3/5) | 20% | 0.6 |

**æ€»åˆ†ï¼š** 3.925 / 5 â‰ˆ **78.5%**

### è¯„çº§

**è¯„çº§ï¼šB+ï¼ˆè‰¯å¥½ï¼‰**

- âœ… **åŠŸèƒ½å®Œæ•´**ï¼Œè®¾è®¡åˆç†
- âœ… **ä»£ç è´¨é‡é«˜**ï¼Œæ˜“ç»´æŠ¤
- âš ï¸ **æµ‹è¯•ä¸å¤Ÿå®Œå–„**ï¼Œç¼ºå°‘æ€§èƒ½éªŒè¯
- âš ï¸ **ç›‘æ§ç¼ºå¤±**ï¼Œç”Ÿäº§ç¯å¢ƒå¯è§‚æµ‹æ€§ä¸è¶³

---

## ğŸ¯ **æ”¹è¿›å»ºè®®**

### ç«‹å³æ”¹è¿›ï¼ˆä¸Šçº¿å‰ï¼‰

1. **æ·»åŠ  Singleflight è¶…æ—¶æ§åˆ¶**ï¼ˆ1å°æ—¶ï¼‰
```python
await asyncio.wait_for(
    self._singleflight.do(key, query_cache),
    timeout=5.0
)
```

2. **ä¿®å¤åºåˆ—åŒ–é—®é¢˜**ï¼ˆ1å°æ—¶ï¼‰
```python
class _CacheNullValue:
    def __reduce__(self):
        return (_CacheNullValue, ())
```

3. **æ·»åŠ åŸºæœ¬ç›‘æ§**ï¼ˆ2å°æ—¶ï¼‰
```python
self._stats = {
    'singleflight_saved': 0,
    'fail_open_count': 0,
    'null_cache_hits': 0,
}
```

### çŸ­æœŸæ”¹è¿›ï¼ˆ1å‘¨å†…ï¼‰

4. **æ€§èƒ½åŸºå‡†æµ‹è¯•**ï¼ˆ4å°æ—¶ï¼‰
5. **å‹åŠ›æµ‹è¯•**ï¼ˆ4å°æ—¶ï¼‰
6. **Prometheus æŒ‡æ ‡å¯¼å‡º**ï¼ˆ4å°æ—¶ï¼‰

### ä¸­æœŸæ”¹è¿›ï¼ˆ1ä¸ªæœˆå†…ï¼‰

7. **é…ç½®å¯¹è±¡é‡æ„**ï¼ˆ4å°æ—¶ï¼‰
8. **æ­£æ€åˆ†å¸ƒ TTL æŠ–åŠ¨**ï¼ˆ2å°æ—¶ï¼‰
9. **å®Œå–„ç›‘æ§é¢æ¿**ï¼ˆ8å°æ—¶ï¼‰

---

## âœ… **ç»“è®º**

### ä¼˜ç‚¹æ€»ç»“

1. âœ… **åŠŸèƒ½å®Œæ•´**ï¼š4ä¸ªæ ¸å¿ƒä¼˜åŒ–å…¨éƒ¨å®æ–½
2. âœ… **è®¾è®¡åˆç†**ï¼šæ¶æ„æ¸…æ™°ï¼ŒèŒè´£åˆ†æ˜
3. âœ… **å‘åå…¼å®¹**ï¼šé»˜è®¤å¯ç”¨ï¼Œé›¶ç ´åæ€§
4. âœ… **ä»£ç è´¨é‡é«˜**ï¼šå¯è¯»æ€§å¥½ï¼Œæ˜“ç»´æŠ¤
5. âœ… **æ–‡æ¡£å®Œå–„**ï¼šä½¿ç”¨æŒ‡å—è¯¦ç»†

### ä¸è¶³æ€»ç»“

1. âš ï¸ **ç¼ºå°‘æ€§èƒ½éªŒè¯**ï¼šæœªè¿›è¡Œå®é™…å‹æµ‹
2. âš ï¸ **ç›‘æ§ä¸è¶³**ï¼šç¼ºå°‘æŒ‡æ ‡å’Œå‘Šè­¦
3. âš ï¸ **æµ‹è¯•ä¸å®Œå–„**ï¼šç¼ºå°‘æ€§èƒ½å’Œå‹åŠ›æµ‹è¯•
4. âš ï¸ **éƒ¨åˆ†ç»†èŠ‚å¾…ä¼˜åŒ–**ï¼šè¶…æ—¶æ§åˆ¶ã€åºåˆ—åŒ–ç­‰

### æœ€ç»ˆå»ºè®®

**ğŸŸ¡ å»ºè®®ï¼šå®Œæˆç«‹å³æ”¹è¿›é¡¹åå¯ä¸Šçº¿**

- âœ… **åŸºç¡€åŠŸèƒ½å®Œå–„**ï¼Œå¯ä»¥ä¸Šçº¿ä½¿ç”¨
- âš ï¸ **å»ºè®®å…ˆå°æµé‡ç°åº¦**ï¼ˆ5% â†’ 20% â†’ 100%ï¼‰
- âš ï¸ **å¯†åˆ‡ç›‘æ§æ€§èƒ½æŒ‡æ ‡**
- âš ï¸ **å‡†å¤‡å›æ»šæ–¹æ¡ˆ**ï¼ˆé…ç½®å…¨éƒ¨å…³é—­ï¼‰

**é¢„æœŸæ•ˆæœï¼š**
- æ€§èƒ½æå‡ï¼š**5-10x**ï¼ˆå®é™…å¯èƒ½ä½äºç†è®ºå€¼ï¼‰
- å¯ç”¨æ€§ï¼š**99%+**ï¼ˆFail-Open ä¿éšœï¼‰
- é£é™©å¯æ§ï¼š**ä¸­ç­‰åä½**

### è¡ŒåŠ¨è®¡åˆ’

```
Day 1-2: å®Œæˆç«‹å³æ”¹è¿›é¡¹ï¼ˆ3é¡¹ï¼‰
Day 3-5: å°æµé‡ç°åº¦ï¼ˆ5%ï¼‰+ ç›‘æ§
Day 6-7: æ‰©å¤§æµé‡ï¼ˆ20% â†’ 50%ï¼‰
Week 2: å…¨é‡ä¸Šçº¿ + æŒç»­ä¼˜åŒ–
```

**æ€»è¯„ï¼šå¯ä»¥ä¸Šçº¿ï¼Œä½†å»ºè®®å…ˆå®Œæˆç«‹å³æ”¹è¿›é¡¹å¹¶è¿›è¡Œç°åº¦å‘å¸ƒã€‚** âœ…
