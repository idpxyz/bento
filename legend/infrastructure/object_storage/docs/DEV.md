   ## 文件上传流程：
   
   1. 接收文件上传请求
   2. 计算文件哈希值
   3. 检查是否存在相同哈希值的文件
      - 如果存在 -> 返回已存在文件的信息（文件去重）
   4. 检查是否存在同名文件
      - 如果存在 -> 创建新版本
      - 如果不存在 -> 创建首个版本
   5. 保存文件内容
   6. 更新或创建元数据
   7. 返回文件信息

   ## 版本管理逻辑

    1. 文件标识
      - 使用文件路径作为唯一标识
      - 同一路径的文件视为同一文件的不同版本
   
   2. 版本号管理
      - 每个文件从版本1开始
      - 同一文件的新版本递增版本号
   
   3. 文件存储
      - 文件内容：{base_path}/files/{type}/{date}/{filename}.v{version}.{ext}
      - 元数据：{base_path}/metadata/{type}/{date}/{filename}.json
   
   4. 元数据结构
      {
          "id": "文件路径",
          "original_filename": "原始文件名",
          "content_type": "文件类型",
          "upload_time": "首次上传时间",
          "current_version": 当前版本号,
          "versions": [
              {
                  "version": 版本号,
                  "timestamp": "版本创建时间",
                  "size": 文件大小,
                  "hash": "文件哈希值",
                  "path": "文件存储路径"
              }
          ]
      }

## 文件去重逻辑

   1. 基于内容去重
      - 相同哈希值的文件被视为重复文件
      - 返回已存在文件的信息，不创建新文件
   
   2. 版本管理
      - 相同路径但内容不同 -> 创建新版本
      - 不同路径但内容相同 -> 返回已存在文件

## 路径处理规则

   1. 路径标准化
      - 统一使用正斜杠(/)
      - 移除首尾的斜杠
      - 保持相对路径格式
   
   2. 目录结构
      - 按文件类型分类
      - 按日期组织
      - 使用版本号区分同一文件的不同版本

## 正确的处理流程

   1. 上传新文件
      - 创建新的元数据文件
      - 版本号从1开始
   
   2. 上传已存在文件（相同路径）
      - 读取现有元数据
      - 版本号+1
      - 保存新的文件内容
      - 更新元数据
   
   3. 上传重复内容（相同哈希值）
      - 返回已存在文件的信息
      - 不创建新文件或新版本

## 获取文件的基本格式

{file_type}/{year}/{month}/{day}/{file_id}.{extension}

# 正确的路径格式
text/2024/12/26/e69d2809-118d-4802-9cf5-73ccccca4095.txt
image/2024/12/26/12b99b9c-e3a8-4be2-8acb-7278a3c539f7.png

从上传文件返回的响应中获取 path 字段，并根据 path 字段生成文件的基本格式
{
    "success": true,
    "path": "text/2024/12/26/e69d2809-118d-4802-9cf5-73ccccca4095.txt",
    "metadata": {
        ...
    }
}

# 获取最新版本的URL
curl -X 'GET' \
  'http://127.0.0.1:8888/storage/url/text/2024/12/26/e69d2809-118d-4802-9cf5-73ccccca4095.txt'

# 获取指定版本的URL
curl -X 'GET' \
  'http://127.0.0.1:8888/storage/url/text/2024/12/26/e69d2809-118d-4802-9cf5-73ccccca4095.txt?version_id=2'

# 注意事项：

1. 不要在路径中包含版本号（不要使用 .v1.txt 这样的格式）
2. 使用上传时返回的 path 字段
3. 路径中的各个部分用 / 分隔
4. 确保包含文件扩展名

所以，正确的使用流程是：
先上传文件，获取返回的 path
使用这个 path 来调用 /storage/url/{path} 接口
如果需要特定版本，添加 version_id 参数
您可以查看上传文件时返回的 path 字段，直接使用那个路径来获取 URL。